<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Using MBrace on Windows Azure
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="An open source framework for large-scale distributed computation and data processing written in F#."/>
    <meta name="author" content="Jan Dzik, Nick Palladinos, Kostas Rontogiannis, Eirik Tsarpalis"/>
    
    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link rel="icon" type="image/png" href="http://www.m-brace.net/img/favicon-196x196.png" sizes="196x196"/>
    <link rel="icon" type="image/png" href="http://www.m-brace.net/img/favicon-160x160.png" sizes="160x160"/>
    <link rel="icon" type="image/png" href="http://www.m-brace.net/img/favicon-96x96.png" sizes="96x96"/>
    <link rel="icon" type="image/png" href="http://www.m-brace.net/img/favicon-16x16.png" sizes="16x16"/>
    <link rel="icon" type="image/png" href="http://www.m-brace.net/img/favicon-32x32.png" sizes="32x32"/>

    <link type="text/css" rel="stylesheet" href="http://www.m-brace.net/content/style.css" />
    <script type="text/javascript" src="http://www.m-brace.net/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://nessos.github.io">nessos</a></li>
          <li><a href="http://github.com/mbraceproject/MBrace.Core">github page</a></li>
        </ul>
        <h3 class="muted"><a href="http://www.m-brace.net/index.html">MBrace</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="Using-MBrace-on-Windows-Azure" class="anchor" href="#Using-MBrace-on-Windows-Azure">Using MBrace on Windows Azure</a></h1>

<p>In this tutorial you will learn how to setup MBrace on Windows Azure and
how to use the MBrace Azure Client API.</p>

<h2><a name="Provisioning-Your-Cluster-Using-Brisk-Engine" class="anchor" href="#Provisioning-Your-Cluster-Using-Brisk-Engine">Provisioning Your Cluster Using Brisk Engine</a></h2>

<p>The easiest path to provision an MBrace cluster on Azure using
an Azure Cloud Service is to use <a href="http://briskengine.com">Brisk Engine</a>.
See <a href="https://github.com/mbraceproject/MBrace.StarterKit/blob/master/azure/brisk-tutorial.md#get-started-with-brisk">Getting Started with MBrace using Brisk Engine</a>.</p>

<h2><a name="Provisioning-Your-Cluster-an-Azure-Cloud-Service-Explicitly" class="anchor" href="#Provisioning-Your-Cluster-an-Azure-Cloud-Service-Explicitly">Provisioning Your Cluster an Azure Cloud Service Explicitly</a></h2>

<p>In some cases you may decide to provision explicitly, if the options provided
by Brisk Engine do not yet meet your needs.</p>

<p>If so, see <a href="https://github.com/mbraceproject/MBrace.StarterKit/blob/master/azure/AZURE.md">Creating a Custom Azure Cloud Service which includes MBrace runtime instances</a>.</p>

<p>For example you may want to:</p>

<ul>
<li><p>use Visual Studio 2012 (F# 3.0, FSharp.Core 4.3.0.0) or Visual Studio 2015 (F# 4.0, FSharp.Core 4.4.0.0) as your client (see below); or</p></li>
<li><p>adjust the size of VM used for worker instances in your cluster; or</p></li>
<li><p>add endpoints to your cloud service (so your MBrace cluster can publish 
TCP and HTTP endpoints, either public or to your virtual network,
for example, you want your MBrace cluster to publish a web server); or</p></li>
<li><p>enable Remote Access to MBrace cluster worker instances; or</p></li>
<li><p>specify the size of local storage available on MBrace cluster worker instances; or</p></li>
<li><p>upload certificates as part of your provisioning process; or</p></li>
<li><p>specify Azure-specific local caching options; or</p></li>
<li><p>include additional web and worker roles in your cloud service; or</p></li>
<li>compile and deploy your own version of the MBrace cluster worker instance software.</li>
</ul>

<p>At the time of writing these options were not yet via the Brisk Engine provisioning
service. In this case, you must create and deploy your own Azure cloud service.</p>

<p>In order to provision explicitly, as a prerequisite you need 
to have a Windows Azure account, basic knowledge of the Azure computing and
optionally Microsoft Visual Studio (or any environment supporting F#).</p>

<h2><a name="Deploying-as-an-Azure-Web-job-or-explicit-VMs" class="anchor" href="#Deploying-as-an-Azure-Web-job-or-explicit-VMs">Deploying as an Azure Web job or explicit VMs</a></h2>

<p>The above deployment techniques use an Azure Cloud Service.
Alternatively you may want to host your MBrace runtime/cluster nodes in one of</p>

<ul>
<li><p>explicit VMs; or</p></li>
<li><p>an Azure web job.</p></li>
</ul>

<p>These options are not yet documented but you may be able
to utilize the relevant components used by the
<a href="https://github.com/mbraceproject/MBrace.StarterKit/blob/master/azure/AZURE.md">Custom Azure Cloud Service</a>.</p>

<h3><a name="Where-your-MBrace-client-code-runs" class="anchor" href="#Where-your-MBrace-client-code-runs">Where your MBrace client code runs</a></h3>

<p>Typically the MBrace client will run in:</p>

<ul>
<li><p>an F# interactive instance in your Visual Studio session; or</p></li>
<li><p>as part of another Azure cloud service, website or web job; or</p></li>
<li><p>as a client desktop process.</p></li>
</ul>

<p>In all cases, the client will need sufficient network access to be able to write to the
Azure storage and Service Bus accounts used by the MBrace runtime/cluster nodes.</p>

<h3><a name="Using-MBrace-Azure-with-F-3-0-Visual-Studio-2012" class="anchor" href="#Using-MBrace-Azure-with-F-3-0-Visual-Studio-2012">Using MBrace.Azure with F# 3.0 (Visual Studio 2012)</a></h3>

<p>MBrace.Azure currently assumes Visual Studio 2013.</p>

<p>If using F# 3.0/Visual Studio 2012, you must use 
a <a href="https://github.com/mbraceproject/MBrace.StarterKit/blob/master/azure/AZURE.md">Custom Azure Cloud Service</a>, and 
add a binding redirect for <code>FSharp.Core</code>:</p>

<table class="pre"><tr><td><pre lang="xml"><span class="k">&lt;</span><span class="i">configuration</span><span class="k">&gt;</span>
  <span class="k">&lt;</span><span class="i">runtime</span><span class="k">&gt;</span>
    <span class="k">&lt;</span><span class="i">assemblyBinding</span> <span class="o">xmlns</span><span class="k">="urn:schemas-microsoft-com:asm.v1"</span><span class="k">&gt;</span>
      <span class="k">&lt;</span><span class="i">dependentAssembly</span><span class="k">&gt;</span>
        <span class="k">&lt;</span><span class="i">assemblyIdentity</span> <span class="o">name</span><span class="k">="FSharp.Core"</span> <span class="o">publicKeyToken</span><span class="k">="b03f5f7f11d50a3a"</span> <span class="o">culture</span><span class="k">="neutral"</span> <span class="k">/&gt;</span>
        <span class="k">&lt;</span><span class="i">bindingRedirect</span> <span class="o">oldVersion</span><span class="k">="0.0.0.0-4.3.1.0"</span> <span class="o">newVersion</span><span class="k">="4.3.0.0"</span> <span class="k">/&gt;</span>
      <span class="k">&lt;/</span><span class="i">dependentAssembly</span><span class="k">&gt;</span>
    <span class="k">&lt;/</span><span class="i">assemblyBinding</span><span class="k">&gt;</span>
  <span class="k">&lt;/</span><span class="i">runtime</span><span class="k">&gt;</span>
<span class="k">&lt;/</span><span class="i">configuration</span><span class="k">&gt;</span>
</pre></td></tr></table>

<h3><a name="Using-MBrace-Azure-with-F-4-0-Visual-Studio-2015" class="anchor" href="#Using-MBrace-Azure-with-F-4-0-Visual-Studio-2015">Using MBrace.Azure with F# 4.0 (Visual Studio 2015)</a></h3>

<p>MBrace.Azure currently assumes Visual Studio 2013.</p>

<p>If using F# 4.0/Visual Studio 2015, you must also use 
a <a href="https://github.com/mbraceproject/MBrace.StarterKit/blob/master/azure/AZURE.md">Custom Azure Cloud Service</a>, and 
add a binding redirect for <code>FSharp.Core</code>:</p>

<table class="pre"><tr><td><pre lang="xml"><span class="k">&lt;</span><span class="i">configuration</span><span class="k">&gt;</span>
  <span class="k">&lt;</span><span class="i">runtime</span><span class="k">&gt;</span>
    <span class="k">&lt;</span><span class="i">assemblyBinding</span> <span class="o">xmlns</span><span class="k">="urn:schemas-microsoft-com:asm.v1"</span><span class="k">&gt;</span>
      <span class="k">&lt;</span><span class="i">dependentAssembly</span><span class="k">&gt;</span>
        <span class="k">&lt;</span><span class="i">assemblyIdentity</span> <span class="o">name</span><span class="k">="FSharp.Core"</span> <span class="o">publicKeyToken</span><span class="k">="b03f5f7f11d50a3a"</span> <span class="o">culture</span><span class="k">="neutral"</span> <span class="k">/&gt;</span>
        <span class="k">&lt;</span><span class="i">bindingRedirect</span> <span class="o">oldVersion</span><span class="k">="0.0.0.0-4.4.0.0"</span> <span class="o">newVersion</span><span class="k">="4.4.0.0"</span> <span class="k">/&gt;</span>
      <span class="k">&lt;/</span><span class="i">dependentAssembly</span><span class="k">&gt;</span>
    <span class="k">&lt;/</span><span class="i">assemblyBinding</span><span class="k">&gt;</span>
  <span class="k">&lt;/</span><span class="i">runtime</span><span class="k">&gt;</span>
<span class="k">&lt;/</span><span class="i">configuration</span><span class="k">&gt;</span></pre></td></tr></table>

<div class="tip" id="fs1">val config : MBrace.Azure.Configuration<br /><br />Full name: Azure-tutorial.config</div>
<div class="tip" id="fs2">module Unchecked<br /><br />from Microsoft.FSharp.Core.Operators</div>
<div class="tip" id="fs3">val defaultof&lt;&#39;T&gt; : &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.Unchecked.defaultof</div>
<div class="tip" id="fs4">namespace MBrace</div>
<div class="tip" id="fs5">namespace MBrace.Azure</div>
<div class="tip" id="fs6">type Configuration =<br />&#160;&#160;{Id: uint16;<br />&#160;&#160;&#160;Version: string;<br />&#160;&#160;&#160;StorageConnectionString: string;<br />&#160;&#160;&#160;ServiceBusConnectionString: string;<br />&#160;&#160;&#160;RuntimeQueue: string;<br />&#160;&#160;&#160;RuntimeTopic: string;<br />&#160;&#160;&#160;RuntimeContainer: string;<br />&#160;&#160;&#160;RuntimeTable: string;<br />&#160;&#160;&#160;RuntimeLogsTable: string;<br />&#160;&#160;&#160;UserDataContainer: string;<br />&#160;&#160;&#160;...}<br />&#160;&#160;member WithId : id:uint16 -&gt; Configuration<br />&#160;&#160;member WithRuntimeFolders : runtimeQueue:string * runtimeTopic:string * runtimeContainer:string * runtimeTable:string * runtimeLogsTable:string * userDataContainer:string * userDataTable:string -&gt; Configuration<br />&#160;&#160;member WithServiceBusConnectionString : conn:string -&gt; Configuration<br />&#160;&#160;member WithStorageConnectionString : conn:string -&gt; Configuration<br />&#160;&#160;member WithUserDataFolders : userDataContainer:string * userDataTable:string -&gt; Configuration<br />&#160;&#160;member WithVersion : version:string -&gt; Configuration<br />&#160;&#160;member ConfigurationId : ConfigurationId<br />&#160;&#160;member WithAppendedId : Configuration<br />&#160;&#160;static member Default : Configuration<br /><br />Full name: MBrace.Azure.Configuration</div>

        </div>
        <div class="span3">
          <a href="http://www.m-brace.net/index.html">
            <img src="http://www.m-brace.net/img/mbrace.png" alt="F# Project" style="width:150px;margin:10px" />
          </a>
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">MBrace</li>
            <li><a href="http://www.m-brace.net/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://www.nuget.org/packages/MBrace.Core">Get Library via NuGet</a></li>
            <li><a href="http://github.com/mbraceproject/MBrace.Core">Source Code on GitHub</a></li>
            <li><a href="http://github.com/mbraceproject/MBrace.Core/blob/master/LICENSE.md">License</a></li>
            <li><a href="http://github.com/mbraceproject/MBrace.Core/blob/master/RELEASE_NOTES.md">Release Notes</a></li>

            <li class="nav-header">Getting Started</li>
            <li><a href="http://www.m-brace.net/azure-tutorial.html">Azure tutorial</a></li>
            <li class="divider"></li>
            <li><a target="_blank" href="http://skillsmatter.com/skillscasts/5157-mbrace-large-scale-distributed-computation-with-f">Video presentation</a></li>
            <li><a target="_blank" href="http://www.m-brace.net/mbrace-plos.pdf">PLOS'13 Publication</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="http://www.m-brace.net/programming-model.html">Programming model</a></li>
            <!--<li><a target="_blank" href="http://www.m-brace.net/mbrace-manual.pdf">MBrace Manual</a></li>-->
            <li><a href="http://www.m-brace.net/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/mbraceproject/MBrace.Core"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
